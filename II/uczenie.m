%uczenie predyktora arx
clear all;
n=0; farx(n+1)=6.575328e+002; foe(n+1)=6.748280e+002; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=5.049948e+002; foe(n+1)=5.876372e+002; krok(n+1)=6.212354e-004; ng(n+1)=2.211021e+003;
n=2; farx(n+1)=1.199289e+002; foe(n+1)=7.560974e+002; krok(n+1)=1.908037e-003; ng(n+1)=2.065375e+003;
n=3; farx(n+1)=5.916002e+001; foe(n+1)=6.172118e+002; krok(n+1)=9.446471e-004; ng(n+1)=1.341028e+003;
n=4; farx(n+1)=1.441757e+001; foe(n+1)=1.645290e+002; krok(n+1)=2.804162e-003; ng(n+1)=1.520314e+003;
n=5; farx(n+1)=8.176579e+000; foe(n+1)=4.942671e+002; krok(n+1)=1.970836e-003; ng(n+1)=5.150023e+002;
n=6; farx(n+1)=6.996247e+000; foe(n+1)=7.065265e+002; krok(n+1)=7.767283e-003; ng(n+1)=1.760091e+002;
n=7; farx(n+1)=5.022495e+000; foe(n+1)=1.126071e+002; krok(n+1)=2.428721e-002; ng(n+1)=1.567696e+002;
n=8; farx(n+1)=3.266109e+000; foe(n+1)=1.158733e+002; krok(n+1)=1.321526e-002; ng(n+1)=2.837649e+002;
n=9; farx(n+1)=1.134972e+000; foe(n+1)=4.054648e+001; krok(n+1)=7.604882e-002; ng(n+1)=8.792152e+001;
n=10; farx(n+1)=9.501792e-001; foe(n+1)=4.765550e+001; krok(n+1)=4.201093e-003; ng(n+1)=1.150907e+002;
n=11; farx(n+1)=8.934245e-001; foe(n+1)=4.190913e+001; krok(n+1)=2.331822e-002; ng(n+1)=5.369882e+001;
n=12; farx(n+1)=8.086676e-001; foe(n+1)=3.990600e+001; krok(n+1)=6.013604e-002; ng(n+1)=3.591453e+001;
n=13; farx(n+1)=5.924229e-001; foe(n+1)=4.589443e+001; krok(n+1)=1.102898e-001; ng(n+1)=3.024243e+001;
n=14; farx(n+1)=5.241376e-001; foe(n+1)=5.174444e+001; krok(n+1)=5.344903e-002; ng(n+1)=8.102042e+001;
n=15; farx(n+1)=3.437287e-001; foe(n+1)=3.528034e+001; krok(n+1)=1.115271e-001; ng(n+1)=6.688893e+001;
n=16; farx(n+1)=3.065662e-001; foe(n+1)=3.736892e+001; krok(n+1)=7.579082e-002; ng(n+1)=4.425382e+001;
n=17; farx(n+1)=2.827793e-001; foe(n+1)=5.129682e+001; krok(n+1)=9.513510e-002; ng(n+1)=2.347463e+001;
n=18; farx(n+1)=2.367916e-001; foe(n+1)=3.028431e+001; krok(n+1)=3.167854e-001; ng(n+1)=2.803366e+001;
n=19; farx(n+1)=2.097995e-001; foe(n+1)=2.253779e+001; krok(n+1)=1.297775e-001; ng(n+1)=3.370075e+001;
n=20; farx(n+1)=2.027518e-001; foe(n+1)=2.202403e+001; krok(n+1)=9.809225e-002; ng(n+1)=1.926579e+001;
n=21; farx(n+1)=1.927926e-001; foe(n+1)=3.133281e+001; krok(n+1)=1.570717e-001; ng(n+1)=1.361550e+001;
n=22; farx(n+1)=1.754290e-001; foe(n+1)=3.125467e+001; krok(n+1)=1.245141e-001; ng(n+1)=2.792793e+001;
n=23; farx(n+1)=1.655809e-001; foe(n+1)=2.518452e+001; krok(n+1)=1.940886e-001; ng(n+1)=9.649793e+000;
n=24; farx(n+1)=1.577981e-001; foe(n+1)=1.782661e+001; krok(n+1)=2.007487e-001; ng(n+1)=1.191799e+001;
n=25; farx(n+1)=1.446528e-001; foe(n+1)=1.402598e+001; krok(n+1)=3.589327e-001; ng(n+1)=1.896207e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.417709e-001; foe(n+1)=1.441452e+001; krok(n+1)=2.698173e-004; ng(n+1)=2.100216e+001;
n=27; farx(n+1)=1.417141e-001; foe(n+1)=1.412690e+001; krok(n+1)=3.467612e-004; ng(n+1)=2.102829e+000;
n=28; farx(n+1)=1.413072e-001; foe(n+1)=1.385676e+001; krok(n+1)=3.214272e-003; ng(n+1)=2.170659e+000;
n=29; farx(n+1)=1.388451e-001; foe(n+1)=1.439447e+001; krok(n+1)=1.406421e-002; ng(n+1)=2.500965e+000;
n=30; farx(n+1)=1.314777e-001; foe(n+1)=1.324842e+001; krok(n+1)=2.960535e-001; ng(n+1)=9.294033e-001;
n=31; farx(n+1)=1.258565e-001; foe(n+1)=1.457291e+001; krok(n+1)=1.533108e-001; ng(n+1)=1.001538e+001;
n=32; farx(n+1)=1.192151e-001; foe(n+1)=1.313697e+001; krok(n+1)=1.845727e-001; ng(n+1)=1.761914e+001;
n=33; farx(n+1)=1.149853e-001; foe(n+1)=2.887059e+001; krok(n+1)=2.268451e-001; ng(n+1)=1.026504e+001;
n=34; farx(n+1)=1.104987e-001; foe(n+1)=3.504330e+001; krok(n+1)=9.990853e-002; ng(n+1)=1.390626e+001;
n=35; farx(n+1)=1.091847e-001; foe(n+1)=3.976864e+001; krok(n+1)=6.259203e-002; ng(n+1)=6.607038e+000;
n=36; farx(n+1)=1.017557e-001; foe(n+1)=1.552552e+001; krok(n+1)=6.709302e-001; ng(n+1)=5.033787e+000;
n=37; farx(n+1)=9.353645e-002; foe(n+1)=1.585015e+001; krok(n+1)=1.527341e-001; ng(n+1)=2.338204e+001;
n=38; farx(n+1)=8.891497e-002; foe(n+1)=1.661103e+001; krok(n+1)=2.440798e-001; ng(n+1)=4.494282e+000;
n=39; farx(n+1)=8.120977e-002; foe(n+1)=1.215326e+001; krok(n+1)=2.775080e-001; ng(n+1)=2.258835e+001;
n=40; farx(n+1)=7.735200e-002; foe(n+1)=9.691817e+000; krok(n+1)=1.022628e-001; ng(n+1)=8.611977e+000;
n=41; farx(n+1)=6.983834e-002; foe(n+1)=8.980083e+000; krok(n+1)=1.653712e-001; ng(n+1)=1.293456e+001;
n=42; farx(n+1)=6.327825e-002; foe(n+1)=7.405245e+000; krok(n+1)=1.961845e-001; ng(n+1)=1.563746e+001;
n=43; farx(n+1)=6.031696e-002; foe(n+1)=8.487624e+000; krok(n+1)=1.775417e-001; ng(n+1)=3.108692e+000;
n=44; farx(n+1)=5.799388e-002; foe(n+1)=6.971230e+000; krok(n+1)=1.079740e-001; ng(n+1)=8.893870e+000;
n=45; farx(n+1)=5.438224e-002; foe(n+1)=8.213273e+000; krok(n+1)=4.461084e-001; ng(n+1)=3.103832e+000;
n=46; farx(n+1)=5.276015e-002; foe(n+1)=8.851275e+000; krok(n+1)=6.694845e-002; ng(n+1)=1.023302e+001;
n=47; farx(n+1)=5.076706e-002; foe(n+1)=8.477192e+000; krok(n+1)=4.044487e-001; ng(n+1)=5.528630e+000;
n=48; farx(n+1)=4.976698e-002; foe(n+1)=8.238813e+000; krok(n+1)=2.991387e-001; ng(n+1)=8.984515e+000;
n=49; farx(n+1)=4.924782e-002; foe(n+1)=8.872599e+000; krok(n+1)=7.271671e-001; ng(n+1)=1.376979e+000;
n=50; farx(n+1)=4.901374e-002; foe(n+1)=8.854891e+000; krok(n+1)=2.272257e-001; ng(n+1)=3.190636e+000;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
